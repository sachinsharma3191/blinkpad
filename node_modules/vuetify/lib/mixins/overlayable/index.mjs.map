{"version":3,"sources":["../../../src/mixins/overlayable/index.ts"],"names":["VOverlay","keyCodes","addOnceEventListener","addPassiveEventListener","getZIndex","Vue","extend","name","props","hideOverlay","Boolean","overlayColor","String","overlayOpacity","Number","data","animationFrame","overlay","watch","value","isActive","removeOverlay","genOverlay","beforeDestroy","methods","createOverlay","propsData","absolute","color","opacity","$mount","parent","$el","parentNode","document","querySelector","insertBefore","firstChild","hideScroll","requestAnimationFrame","activeZIndex","undefined","zIndex","showScroll","removeChild","$destroy","cancelAnimationFrame","scrollListener","e","type","includes","target","tagName","isContentEditable","up","pageup","down","pagedown","keyCode","deltaY","body","checkPath","preventDefault","hasScrollbar","el","nodeType","Node","ELEMENT_NODE","style","window","getComputedStyle","overflowY","scrollHeight","clientHeight","shouldScroll","delta","hasAttribute","alreadyAtTop","scrollTop","alreadyAtBottom","scrollingUp","scrollingDown","isInside","path","composedPath","dialog","$refs","selected","getSelection","anchorNode","index","length","documentElement","content","push","parentElement","$vuetify","breakpoint","smAndDown","classList","add","passive","addEventListener","remove","removeEventListener"],"mappings":"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","sourcesContent":["// @ts-nocheck\n/* eslint-disable */\n\n// Components\nimport VOverlay from '../../components/VOverlay'\n\n// Utilities\nimport {\n  keyCodes,\n  addOnceEventListener,\n  addPassiveEventListener,\n  getZIndex,\n} from '../../util/helpers'\n\n// Types\nimport Vue from 'vue'\n\ninterface Toggleable extends Vue {\n  isActive?: boolean\n}\n\ninterface Stackable extends Vue {\n  activeZIndex: number\n}\n\ninterface options {\n  absolute?: boolean\n  $refs: {\n    dialog?: HTMLElement\n    content?: HTMLElement\n  }\n}\n\n/* @vue/component */\nexport default Vue.extend<Vue & Toggleable & Stackable & options>().extend({\n  name: 'overlayable',\n\n  props: {\n    hideOverlay: Boolean,\n    overlayColor: String,\n    overlayOpacity: [Number, String],\n  },\n\n  data () {\n    return {\n      animationFrame: 0,\n      overlay: null as InstanceType<typeof VOverlay> | null,\n    }\n  },\n\n  watch: {\n    hideOverlay (value) {\n      if (!this.isActive) return\n\n      if (value) this.removeOverlay()\n      else this.genOverlay()\n    },\n  },\n\n  beforeDestroy () {\n    this.removeOverlay()\n  },\n\n  methods: {\n    createOverlay () {\n      const overlay = new VOverlay({\n        propsData: {\n          absolute: this.absolute,\n          value: false,\n          color: this.overlayColor,\n          opacity: this.overlayOpacity,\n        },\n      })\n\n      overlay.$mount()\n\n      const parent = this.absolute\n        ? this.$el.parentNode\n        : document.querySelector('[data-app]')\n\n      parent && parent.insertBefore(overlay.$el, parent.firstChild)\n\n      this.overlay = overlay\n    },\n    genOverlay () {\n      this.hideScroll()\n\n      if (this.hideOverlay) return\n\n      if (!this.overlay) this.createOverlay()\n\n      this.animationFrame = requestAnimationFrame(() => {\n        if (!this.overlay) return\n\n        if (this.activeZIndex !== undefined) {\n          this.overlay.zIndex = String(this.activeZIndex - 1)\n        } else if (this.$el) {\n          this.overlay.zIndex = getZIndex(this.$el)\n        }\n\n        this.overlay.value = true\n      })\n\n      return true\n    },\n    /** removeOverlay(false) will not restore the scollbar afterwards */\n    removeOverlay (showScroll = true) {\n      if (this.overlay) {\n        addOnceEventListener(this.overlay.$el, 'transitionend', () => {\n          if (\n            !this.overlay ||\n            !this.overlay.$el ||\n            !this.overlay.$el.parentNode ||\n            this.overlay.value ||\n            this.isActive\n          ) return\n\n          this.overlay.$el.parentNode.removeChild(this.overlay.$el)\n          this.overlay.$destroy()\n          this.overlay = null\n        })\n\n        // Cancel animation frame in case\n        // overlay is removed before it\n        // has finished its animation\n        cancelAnimationFrame(this.animationFrame)\n\n        this.overlay.value = false\n      }\n\n      showScroll && this.showScroll()\n    },\n    scrollListener (e: WheelEvent & KeyboardEvent) {\n      if (e.type === 'keydown') {\n        if (\n          ['INPUT', 'TEXTAREA', 'SELECT'].includes((e.target as Element).tagName) ||\n          // https://github.com/vuetifyjs/vuetify/issues/4715\n          (e.target as HTMLElement).isContentEditable\n        ) return\n\n        const up = [keyCodes.up, keyCodes.pageup]\n        const down = [keyCodes.down, keyCodes.pagedown]\n\n        if (up.includes(e.keyCode)) {\n          (e as any).deltaY = -1\n        } else if (down.includes(e.keyCode)) {\n          (e as any).deltaY = 1\n        } else {\n          return\n        }\n      }\n\n      if (e.target === this.overlay ||\n        (e.type !== 'keydown' && e.target === document.body) ||\n        this.checkPath(e)) e.preventDefault()\n    },\n    hasScrollbar (el?: Element) {\n      if (!el || el.nodeType !== Node.ELEMENT_NODE) return false\n\n      const style = window.getComputedStyle(el)\n      return ['auto', 'scroll'].includes(style.overflowY!) && el.scrollHeight > el.clientHeight\n    },\n    shouldScroll (el: Element, delta: number): boolean {\n      if (el.hasAttribute('data-app')) return false\n\n      const alreadyAtTop = el.scrollTop === 0\n      const alreadyAtBottom = el.scrollTop + el.clientHeight === el.scrollHeight\n      const scrollingUp = delta < 0\n      const scrollingDown = delta > 0\n\n      if (!alreadyAtTop && scrollingUp) return true\n      if (!alreadyAtBottom && scrollingDown) return true\n      if ((alreadyAtTop || alreadyAtBottom)) {\n        return this.shouldScroll(el.parentNode as Element, delta)\n      }\n\n      return false\n    },\n    isInside (el: Element, parent: Element): boolean {\n      if (el === parent) {\n        return true\n      } else if (el === null || el === document.body) {\n        return false\n      } else {\n        return this.isInside(el.parentNode as Element, parent)\n      }\n    },\n    checkPath (e: WheelEvent) {\n      const path = e.path || this.composedPath(e)\n      const delta = e.deltaY\n\n      if (e.type === 'keydown' && path[0] === document.body) {\n        const dialog = this.$refs.dialog\n        // getSelection returns null in firefox in some edge cases, can be ignored\n        const selected = window.getSelection()!.anchorNode as Element\n        if (dialog && this.hasScrollbar(dialog) && this.isInside(selected, dialog)) {\n          return !this.shouldScroll(dialog, delta)\n        }\n        return true\n      }\n\n      for (let index = 0; index < path.length; index++) {\n        const el = path[index]\n\n        if (el === document) return true\n        if (el === document.documentElement) return true\n        if (el === this.$refs.content) return true\n\n        if (this.hasScrollbar(el as Element)) return !this.shouldScroll(el as Element, delta)\n      }\n\n      return true\n    },\n    /**\n     * Polyfill for Event.prototype.composedPath\n     */\n    composedPath (e: WheelEvent): EventTarget[] {\n      if (e.composedPath) return e.composedPath()\n\n      const path = []\n      let el = e.target as Element\n\n      while (el) {\n        path.push(el)\n\n        if (el.tagName === 'HTML') {\n          path.push(document)\n          path.push(window)\n\n          return path\n        }\n\n        el = el.parentElement!\n      }\n      return path\n    },\n    hideScroll () {\n      if (this.$vuetify.breakpoint.smAndDown) {\n        document.documentElement!.classList.add('overflow-y-hidden')\n      } else {\n        addPassiveEventListener(window, 'wheel', this.scrollListener as EventHandlerNonNull, { passive: false })\n        window.addEventListener('keydown', this.scrollListener as EventHandlerNonNull)\n      }\n    },\n    showScroll () {\n      document.documentElement!.classList.remove('overflow-y-hidden')\n      window.removeEventListener('wheel', this.scrollListener as EventHandlerNonNull)\n      window.removeEventListener('keydown', this.scrollListener as EventHandlerNonNull)\n    },\n  },\n})\n"],"file":"index.mjs"}